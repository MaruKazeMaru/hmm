# hmm
## 概要
HMM（Hidden Markov Model, 隠れマルコフモデル）をシミュレートするコードです。<br>
言語はC++です。<br>
主な機能は
* 評価：Forwardアルゴリズムによるシンボル列の観測確率計算
* 学習：Baum-Welchアルゴリズムによるパラメータ更新

の2つです。

## 動作確認済み環境
wsl2<br>
Ubuntu 20.04
gcc 9.4

## 使用方法
### ビルド
```bash
bash biuld.bash
```
### 実行
#### 評価
モデル、シンボル列を入力しシンボル列の出現確率を出力します。<br>
1<br>
下記のコマンドを実行します。
```bash
build/forward.out
```
2<br>
モデルの構造とパラメータ、シンボル列を標準入力で渡します。<br>
入力は下記のように6つの部分を順に並べます。
```
<状態の数>
<シンボルの数>
<シンボル出力確率>
<状態遷移確率>
<シンボル列の長さ>
<シンボル列>
```
各部分は下記のように入力します。<br>
* 状態の数：状態の数&emsp;ただし始点と終点も含めるので、シンボルを出力する状態の数+2になる<br>
* シンボルの数：シンボルの数<br>
* シンボル出力確率：<br>
行数=シンボルを出力する状態の数、列数=シンボルの数&nbsp;の浮動小数の配列&emsp;列の区切り文字は,(半角カンマ)<br>
i行k列目にはi番目の状態がk番目のシンボルを出力する確率<br>
* 状態遷移確率：<br>
行数=状態の数-1、列数=状態の数&nbsp;の浮動小数の配列&emsp;列の区切り文字は,(半角カンマ)<br>
i行j列目にはi番目の状態からj番目の状態に遷移する確率<br>
ただし便宜上、0番目の状態=始点、*状態の数*番目の状態=終点とする<br>
* シンボル列の長さ：出力確率を計算したいシンボル列の長さ<br>
* シンボル列：シンボルを改行区切りで<br>

3<br>
シンボル列の出現確率が出力されます。
##### 実行例
下記のようなモデル、シンボル列を入力したいとします。

入力
```
3
2
0.4,0.6
0,1,0
0,0.8,0.2
3
1
1
0
```
出力
```
0.018432
```
#### 学習
テンプレートとなるモデルにランダムなシンボル列を生成させ、パラメータ未知のモデルにそのシンボル列を学習させます。<br>
（未知モデルの構造はテンプレートモデルと同じになります。）<br>
1<br>
下記コマンドを実行します。
```bash
build/baumwelch.out
```
2<br>
テンプレートモデルの構造とパラメータ、生成するシンボル列の個数、学習を繰り返す回数の上限を標準入力で渡します。<br>
入力は下記のように6つの部分を順に並べます。
```
<テンプレートモデルの状態の数>
<シンボルの数>
<テンプレートモデルのシンボル出力確率>
<テンプレートモデルの状態遷移確率>
<シンボル列の個数>
<最大繰り返し回数>
```
各部分は下記のように入力します。<br>
* テンプレートモデルの状態の数&thinsp;~&thinsp;テンプレートモデルの状態遷移確率：<br>評価のときと同様
* シンボル列の個数：学習用に生成するシンボル列の個数
* 最大繰り返し回数：学習を繰り返す回数の上限

3<br>
学習後の未知モデルのパラメータを出力します。
##### 実行例

入力
```
```
出力
```
```
